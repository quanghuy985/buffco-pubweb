<?php $__env->startSection('titleAdmin'); ?>
<?php echo Lang::get('backend/title.project.title'); ?>
<?php $__env->stopSection(); ?>
<?php $__env->startSection("contentadmin"); ?>
<script>
    jQuery(document).ready(function () {

    jQuery('.deletepromulti').click(function () {
    var addon = '';
            av = document.getElementsByName("checkboxidfile");
            for (e = 0; e < av.length; e++) {
    if (av[e].checked == true) {
    addon += av[e].value + ',';
    }
    }
    if (addon != '') {
    jConfirm("<?php echo Lang::get('messages.delete_confirm'); ?>", "<?php echo Lang::get('messages.alert'); ?>", function (r) {
    if (r == true) {
    jQuery.post("<?php echo URL::action('\BackEnd\ProjectController@postDelmulte'); ?>", {multiid: addon}).done(function (data) {
    window.location = '<?php echo URL::action('\BackEnd\ProjectController@getProjectView'); ?>';
    });
            return false;
    } else {
    return false;
    }
    });
    } else {
    jAlert("<?php echo Lang::get('messages.select_empty'); ?>", "<?php echo Lang::get('messages.alert'); ?>");
    }
    });
            jQuery('#searchblur').keypress(function (e) {
    // Enter pressed?
    if (e.which == 10 || e.which == 13) {
    var request = jQuery.ajax({
    url: "<?php echo URL::action('\BackEnd\ProjectController@postAjaxsearch'); ?>?keyword=" + jQuery('#searchblur').val(),
            type: "POST",
            dataType: "html"
    });
            request.done(function (msg) {
            jQuery('#tableproduct').html(msg);
            });
    }
    });
            jQuery("#loctheotieuchi").click(function () {
    var request = jQuery.ajax({
    url: "<?php echo URL::action('\BackEnd\ProjectController@postFillterProject'); ?>?status=" + jQuery('#oderbyoption1').val(),
            type: "POST",
            dataType: "html"
    });
            request.done(function (msg) {
            jQuery('#tableproduct').html(msg);
            });
    });
    });
            function phantrang(page) {
            jQuery("#jGrowl").remove();
                    jQuery.jGrowl("<?php echo Lang::get('messages.data_loading'); ?>");
                    var urlpost = "<?php echo URL::action('\BackEnd\ProjectController@postAjaxproject'); ?>?page=" + page
                    if (jQuery('#oderbyoption1').val() != '') {
            urlpost = "<?php echo URL::action('\BackEnd\ProjectController@postFillterProject'); ?>?status=" + jQuery('#oderbyoption1').val() + "&page=" + page;
            }
            if (jQuery('#searchblur').val() != '') {
            urlpost = "<?php echo URL::action('\BackEnd\ProjectController@postAjaxsearch'); ?>?keyword=" + jQuery('#searchblur').val() + "&page=" + page;
            }
            var request = jQuery.ajax({
            url: urlpost,
                    type: "POST",
                    dataType: "html"
            });
                    request.done(function (msg) {
                    jQuery("#jGrowl").remove();
                            jQuery.jGrowl("<?php echo Lang::get('messages.data_load_success'); ?>");
                            jQuery('#tableproduct').html(msg);
                    });
            }


    function xoasanpham(id) {
    jConfirm("<?php echo Lang::get('messages.delete_confirm'); ?>", "<?php echo Lang::get('messages.alert'); ?>", function (r) {
    if (r == true) {
    var request = jQuery.ajax({
    url: "<?php echo URL::action('\BackEnd\ProjectController@postDeleteProject'); ?>?id=" + id,
            type: "POST",
            dataType: "html"
    });
            request.done(function (msg) {
            jQuery('#tableproduct').html(msg);
            });
            return false;
    } else {
    return false;
    }
    })
    }

    function kichhoat(id, stus) {
    var request = jQuery.ajax({
    url: "<?php echo URL::action('\BackEnd\ProjectController@postProjectActive'); ?>?id=" + id + '&status=' + stus,
            type: "POST",
            dataType: "html"
    });
            request.done(function (msg) {
            jQuery('#tableproduct').html(msg);
            });
            return true;
    }
</script>
<div class="pageheader notab">
    <h1 class="pagetitle"><?php echo Lang::get('backend/title.project.heading'); ?></h1>
    <span class="pagedesc"><?php echo Lang::get('backend/title.project.description'); ?></span>
</div>

<div class="contentwrapper">
    <?php echo $__env->make('backend.alert', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
    <div class="subcontent">
        <div class="contenttitle2">
            <h3><?php echo Lang::get('backend/title.project.caption'); ?></h3>
        </div>

        <div class="tableoptions">
            <button class="deletepromulti" title="table1"><?php echo Lang::get('general.delete_select'); ?></button>&nbsp;
            <?php
            $selectData = Lang::get('general.data_status');
            echo Form::select('oderbyoption1', $selectData, '', array('id' => 'oderbyoption1'));
            ?>&nbsp;
            <button class="radius3" id="loctheotieuchi"><?php echo Lang::get('general.filter'); ?></button>
            <div class="dataTables_filter1" id="searchformfile">
                <label><?php echo Lang::get('general.search'); ?>:
                    <input id="searchblur" name="searchblur"
                           style="border: 1px solid #ddd;padding: 7px 5px 8px 5px;width: 200px;background: #fff;"
                           type="text">
                </label>
            </div>
        </div>
        <table cellpadding="0" cellspacing="0" border="0" id="table2" class="stdtable stdtablecb">
            <colgroup>
                <col class="con0" style="width: 3%">
                <col class="con1" style="width: 10%">
                <col class="con1" style="width: 10%">
                <col class="con0" style="width: 14%">
                <col class="con1" style="width: 20%">
                <col class="con0" style="width: 15%">
                <col class="con1" style="width: 10%">

            </colgroup>
            <thead>
                <tr>
                    <th class="head0"></th>
                    <th class="head1"><?php echo Lang::get('general.date_begin'); ?></th>
                    <th class="head1"><?php echo Lang::get('general.date_end'); ?></th>
                    <th class="head0"><?php echo Lang::get('general.project_name'); ?></th>
                    <th class="head1"><?php echo Lang::get('general.content'); ?></th>
                    <th class="head0"><?php echo Lang::get('general.time'); ?></th>
                    <th class="head1"><?php echo Lang::get('general.status'); ?></th>
                    <th class="head1"><?php echo Lang::get('general.action'); ?></th>
                </tr>
            </thead>

            <tbody id="tableproduct" class="tabledataajax">
                <?php if(count($arrayProject)>0): ?>
                <?php foreach($arrayProject as $item): ?>
                <tr>
                    <td><input name="checkboxidfile" type="checkbox" value="<?php echo $item->id; ?>"></td>
                    <td><label value="project"></label><?php echo date('d/m/Y', $item->from); ?></td>
                    <td><label value="project"></label><?php echo date('d/m/Y', $item->to); ?></td>
                    <td><label value="project"><?php echo str_limit( $item->projectName, 30, '...'); ?></label></td>
                    <td><label value="project"><?php echo str_limit($item->projectContent, 30, '...'); ?> </label></td>
                    <td><label value="project"></label><?php echo date('d/m/Y h:i:s', $item->time); ?></td>
                    <td><label value="project">
                            <?php
                            if (array_key_exists($item->status, $selectData)) {
                                echo $selectData[$item->status];
                            }
                            ?>
                        </label>
                    </td>
                    <td>
                        <a href="<?php echo URL::action('\BackEnd\ProjectController@getProjectEdit',$item->id); ?>"
                           class="btn btn4 btn_book" title="<?php echo Lang::get('button.btn.book'); ?>"></a>
                        <?php if($item->status=='2'): ?>
                        <a href="javascript:void(0)" onclick="kichhoat(<?php echo $item-> id; ?>, 0)" class="btn btn4 btn_flag"
                           title="<?php echo Lang::get('button.btn.flag'); ?>"></a>
                        <?php endif; ?>
                        <?php if($item->status=='0'): ?>
                        <a href="javascript:void(0)" onclick="kichhoat(<?php echo $item-> id; ?>, 1)" class="btn btn4 btn_world"
                           title="<?php echo Lang::get('button.btn.world'); ?>"></a>
                        <?php endif; ?>
                        <?php if($item->status!='2'): ?>
                        <a href="javascript: void(0)" onclick="xoasanpham(<?php echo $item-> id; ?>)" class="btn btn4 btn_trash"
                           title="<?php echo Lang::get('button.btn.trash'); ?>"></a>
                        <?php endif; ?>
                    </td>
                </tr>
                <?php endforeach; ?>
                <?php if($link!=''): ?>
                <tr>
                    <td colspan="8"><?php echo $link; ?></td>
                </tr>
                <?php endif; ?>

                <?php else: ?>
                <tr>
                    <td colspan="8">
                        <?php echo Lang::get('general.data_empty'); ?>
                    </td>
                </tr>
                <?php endif; ?>

            </tbody>
        </table>
    </div>
</div>
<?php $__env->stopSection(); ?>


<?php echo $__env->make("backend.template", array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>